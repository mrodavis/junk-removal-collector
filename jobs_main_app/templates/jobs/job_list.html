{% extends 'base.html' %}
{% load static %}

{% block head %}
<link rel="stylesheet" href="{% static 'css/jobs/job-index.css' %}">
{% endblock %}

{% block content %}
<h1>All Jobs</h1>

<a href="{% url 'job_create' %}" class="btn">+ Add Job</a>

<div class="card-container">
  {% for job in jobs %}
    <div class="card">
      <div class="card-content">
        <h2>{{ job.title }}</h2>
        <p><strong>Customer:</strong> {{ job.customer.name }}</p>
        <p><strong>Address:</strong> {{ job.address }}</p>
        <p><strong>Date:</strong> {{ job.date|date:"M d, Y" }}</p>
        <p><strong>Haulers:</strong>
          {% if job.haulers.all %}
            {% for hauler in job.haulers.all %}
              {{ hauler.name }}{% if not forloop.last %}, {% endif %}
            {% endfor %}
          {% else %}
            No haulers assigned
          {% endif %}
        </p>
        
        <!-- Status badge -->
        <p>
          <span class="status {{ job.status|lower|slugify }}">
            {{ job.status }}
          </span>
        </p>

        <!-- Links -->
        <p>
          <a href="{% url 'job_detail' job.id %}">View Details</a> |
          <a href="{% url 'job_update' job.id %}">Edit</a> |
          <a href="{% url 'job_delete' job.id %}">Delete</a>
        </p>
      </div>
    </div>
  {% empty %}
    <p>No jobs found.</p>
  {% endfor %}
</div>
{% endblock %}
